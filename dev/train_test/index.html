<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Training-Testing · PosDefManifoldML</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link href="../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><a href="../"><img class="logo" src="../assets/logo.png" alt="PosDefManifoldML logo"/></a><h1>PosDefManifoldML</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../">PosDefManifoldML Documentation</a></li><li><a class="toctext" href="../tutorial/">Tutorials</a></li><li><a class="toctext" href="../MainModule/">Main Module</a></li><li class="current"><a class="toctext" href>Training-Testing</a><ul class="internal"><li><a class="toctext" href="#Content-1">Content</a></li></ul></li><li><a class="toctext" href="../tools/">Tools</a></li><li><span class="toctext">Machine Learning Models</span><ul><li><a class="toctext" href="../mdm/">Minimum Distance to Mean</a></li></ul></li></ul></nav><article id="docs"><header><nav><ul><li><a href>Training-Testing</a></li></ul><a class="edit-page" href="https://github.com/Marco-Congedo/PosDefManifoldML.jl/blob/master/docs/src/train_test.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Training-Testing</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="train_test.jl-1" href="#train_test.jl-1">train_test.jl</a></h1><p>This unit implements train-testing and cross-validation procedures.</p><h2><a class="nav-anchor" id="Content-1" href="#Content-1">Content</a></h2><table><tr><th style="text-align: left">Function</th><th style="text-align: left">Description</th></tr><tr><td style="text-align: left"><a href="#PosDefManifoldML.fit!"><code>fit!</code></a></td><td style="text-align: left">fit (train) a machine larning model</td></tr><tr><td style="text-align: left"><a href="#PosDefManifoldML.predict"><code>predict</code></a></td><td style="text-align: left">predict labels or probabilities</td></tr><tr><td style="text-align: left"><a href="#PosDefManifoldML.CVscore"><code>CVscore</code></a></td><td style="text-align: left">cross-validation score</td></tr></table><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="PosDefManifoldML.fit!" href="#PosDefManifoldML.fit!"><code>PosDefManifoldML.fit!</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">function fit!(model :: MLmodel,
              𝐏Tr     :: ℍVector,
              yTr     :: Vector;
           w  :: Vector= [],
           ✓w :: Bool  = true,
           ⏩ :: Bool  = true)</code></pre><p>Fit a machine learning model <a href="../MainModule/#ML-model-1">ML model</a>, with training data <code>𝐏Tr</code>, of type <a href="https://marco-congedo.github.io/PosDefManifold.jl/dev/MainModule/#%E2%84%8DVector-type-1">ℍVector</a>, and corresponding labels <code>yTr</code>, of type <a href="../MainModule/#IntVector-1">IntVector</a>. Return the fitted model.</p><p>Only the <a href="../mdm/#PosDefManifoldML.MDM"><code>MDM</code></a> model is supported for the moment being.</p><p><strong>MDM model</strong></p><p>For this model, fitting involves computing a mean of all the matrices in each class. Those class means are computed according to the metric specified by the <a href="../mdm/#PosDefManifoldML.MDM"><code>MDM</code></a> constructor.</p><p>See method (3) of the <a href="https://marco-congedo.github.io/PosDefManifold.jl/dev/riemannianGeometry/#Statistics.mean">mean</a> function for the meaning of the optional keyword arguments <code>w</code>, <code>✓w</code> and <code>⏩</code>, to which they are passed.</p><p>Note that the MDM model can be created and fitted in one pass using a specia <a href="../mdm/#PosDefManifoldML.MDM"><code>MDM</code></a> constructor.</p><p><strong>See</strong>: <a href="../MainModule/#notation-and-nomenclature-1">notation &amp; nomenclature</a>, <a href="../MainModule/#the-ℍVector-type-1">the ℍVector type</a>.</p><p><strong>See also</strong>: <a href="#PosDefManifoldML.predict"><code>predict</code></a>, <a href="#PosDefManifoldML.CVscore"><code>CVscore</code></a>.</p><p><strong>Examples</strong></p><pre><code class="language-none">using PosDefManifoldML

# generate some data
𝐏Tr, 𝐏Te, yTr, yTe=gen2ClassData(10, 30, 40, 60, 80, 0.25)

# create an MDM model
model = MDM(Fisher)

# fit (train) the model
fit!(model, 𝐏Tr, yTr)

# using a special constructor you don&#39;t need the fit! function:
𝐏Tr, 𝐏Te, yTr, yTe=gen2ClassData(10, 30, 40, 60, 80, 0.25)
model=MDM(Fisher, 𝐏Tr, yTr)</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/Marco-Congedo/PosDefManifoldML.jl/blob/ddcb1864fbcc8b448b4e1760f8633766e6d6d47a/src/train_test.jl#L16-L69">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="PosDefManifoldML.predict" href="#PosDefManifoldML.predict"><code>PosDefManifoldML.predict</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">function predict(model  :: MLmodel,
                 𝐏Te    :: ℍVector,
                 what   :: Symbol=:labels)</code></pre><p>Given a <a href="../MainModule/#ML-model-1">ML model</a> <code>model</code> trained (fitted) on <span>$z$</span> classes and a testing set of <span>$k$</span> positive definite matrices <code>𝐏Te</code> of type <a href="https://marco-congedo.github.io/PosDefManifold.jl/dev/MainModule/#%E2%84%8DVector-type-1">ℍVector</a>,</p><p>if <code>what</code> is <code>:labels</code> or <code>:l</code> (default), return the predicted <strong>class labels</strong> for each matrix in <code>𝐏Te</code> as an <a href="../MainModule/#IntVector-1">IntVector</a>;</p><p>if <code>what</code> is <code>:probabilities</code> or <code>:p</code>, return the predicted <strong>probabilities</strong> for each matrix in <code>𝐏Te</code> to belong to a all classes, as a <span>$k$</span>-vector of <span>$z$</span> vectors holding reals in <span>$(0, 1)$</span> (probabilities).</p><p>Only the <a href="../mdm/#PosDefManifoldML.MDM"><code>MDM</code></a> model is supported for the moment being.</p><p><strong>MDM model</strong></p><p>For this model, the predicted class of an unlabeled matrix is the class whose mean is the closest to the matrix (minimum distance to mean).</p><p>The probabilities instead are obtained passing to a <a href="https://en.wikipedia.org/wiki/Softmax_function">softmax function</a> the distances of each unlabeled matrix to all class means.</p><p><strong>See</strong>: <a href="../MainModule/#notation-and-nomenclature-1">notation &amp; nomenclature</a>, <a href="../MainModule/#the-ℍVector-type-1">the ℍVector type</a>.</p><p><strong>See also</strong>: <a href="#PosDefManifoldML.fit!"><code>fit!</code></a>, <a href="#PosDefManifoldML.CVscore"><code>CVscore</code></a>.</p><p><strong>Examples</strong></p><pre><code class="language-none">using PosDefManifoldML

# generate some data
𝐏Tr, 𝐏Te, yTr, yTe=gen2ClassData(10, 30, 40, 60, 80)

# craete and fit an MDM model
model=MDM(Fisher, 𝐏Tr, yTr)

# predict labels
predict(model, 𝐏Te, :l)

# predict probabilities
predict(model, 𝐏Te, :p)</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/Marco-Congedo/PosDefManifoldML.jl/blob/ddcb1864fbcc8b448b4e1760f8633766e6d6d47a/src/train_test.jl#L102-L150">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="PosDefManifoldML.CVscore" href="#PosDefManifoldML.CVscore"><code>PosDefManifoldML.CVscore</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">function CVscore(model :: MLmodel,
                 𝐏Tr   :: ℍVector,
                 yTr   :: Vector,
                 nCV   :: Int = 5;
            scoring   :: Symbol = :b,
            confusion :: Bool   = false,
            shuffle   :: Bool   = false)</code></pre><p>Cross-validation: Given an ℍVector <code>𝐏Tr</code> holding <code>k</code> Hermitian matrices, a Vector <code>yTr</code> holding the <code>k</code> labels for these matrices, the number of cross-validations <code>nCV</code> and an <a href="../MainModule/#ML-model-1">ML model</a> <code>model</code>, retrun a vector <code>scores</code> of <code>nCV</code> accuracies, one for each cross-validation.</p><p>If <code>scoring= :b</code> (default) the balanced accuracy is computed. Any other value will make the function returning the regular accuracy.</p><p>If <code>confusion=true</code> (dafault=false), return the 2-tuple <code>C, scores</code>, where <code>C</code> is a <code>nCV</code>-vector of the confusion matrices for each cross-validation set, otherwise return only <code>scores</code>.</p><p><strong>See</strong>: <a href="../MainModule/#notation-and-nomenclature-1">notation &amp; nomenclature</a>, <a href="../MainModule/#the-ℍVector-type-1">the ℍVector type</a>.</p><p><strong>See also</strong>: <a href="#PosDefManifoldML.fit!"><code>fit!</code></a>, <a href="#PosDefManifoldML.predict"><code>predict</code></a>.</p><p><strong>Examples</strong></p><pre><code class="language-none">using PosDefManifoldML

# generate some data
𝐏Tr, 𝐏Te, yTr, yTe=gen2ClassData(10, 30, 40, 60, 80)

# craete and fit an MDM model
model=MDM(Fisher, 𝐏Tr, yTr)

# perform cross-validation
CVscore(model, 𝐏Te, yTe, 5)</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/Marco-Congedo/PosDefManifoldML.jl/blob/ddcb1864fbcc8b448b4e1760f8633766e6d6d47a/src/train_test.jl#L178-L217">source</a></section><footer><hr/><a class="previous" href="../MainModule/"><span class="direction">Previous</span><span class="title">Main Module</span></a><a class="next" href="../tools/"><span class="direction">Next</span><span class="title">Tools</span></a></footer></article></body></html>
