<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Minimum Distance to Mean · PosDefManifoldML</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link href="../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><a href="../"><img class="logo" src="../assets/logo.png" alt="PosDefManifoldML logo"/></a><h1>PosDefManifoldML</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../">PosDefManifoldML Documentation</a></li><li><a class="toctext" href="../tutorial/">Tutorials</a></li><li><a class="toctext" href="../MainModule/">Main Module</a></li><li><a class="toctext" href="../train_test/">Training-Testing</a></li><li><a class="toctext" href="../tools/">Tools</a></li><li><span class="toctext">Machine Learning Models</span><ul><li class="current"><a class="toctext" href>Minimum Distance to Mean</a><ul class="internal"></ul></li></ul></li></ul></nav><article id="docs"><header><nav><ul><li>Machine Learning Models</li><li><a href>Minimum Distance to Mean</a></li></ul><a class="edit-page" href="https://github.com/Marco-Congedo/PosDefManifoldML.jl/blob/master/docs/src/mdm.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Minimum Distance to Mean</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="mdm.jl-1" href="#mdm.jl-1">mdm.jl</a></h1><p>This unit implemets the Riemannian <strong>MDM (Minimum Distance to Mean)</strong> classifier for the manifold of positive definite matrices.</p><p>Besides the <a href="#PosDefManifoldML.MDM"><code>MDM</code></a> type declaration and the declaration of some constructors for it, this unit also include the following functions, which typically you will not need to access directly:</p><table><tr><th style="text-align: left">function</th><th style="text-align: left">description</th></tr><tr><td style="text-align: left"><a href="#PosDefManifoldML.getMeans"><code>getMeans</code></a></td><td style="text-align: left">compute means of training data for fitting the MDM model</td></tr><tr><td style="text-align: left"><a href="#PosDefManifoldML.getDistances"><code>getDistances</code></a></td><td style="text-align: left">compute the distances of a matrix set to a set of means</td></tr><tr><td style="text-align: left"><a href="#PosDefManifoldML.CV_mdm"><code>CV_mdm</code></a></td><td style="text-align: left">perform cross-validations for the MDM classifiers</td></tr></table><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="PosDefManifoldML.MDM" href="#PosDefManifoldML.MDM"><code>PosDefManifoldML.MDM</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-julia">(1)
mutable struct MDM &lt;: MLmodel
    metric :: Metric
    means
    function MDM(metric :: Metric; means = nothing)
        new(metric, means)
    end
end

(2)
function MDM(metric :: Metric,
             𝐏Tr    :: ℍVector,
             yTr    :: IntVector;
           w  :: Vector = [],
           ✓w :: Bool  = true)</code></pre><p>(1)</p><p>MDM machine learning models are incapsulated in this mutable structure. MDM models have two fields: <code>.metric</code> and <code>.means</code>.</p><p>The field <code>metric</code>, of type <a href="https://marco-congedo.github.io/PosDefManifold.jl/dev/MainModule/#Metric::Enumerated-type-1">Metric</a>, is to be specified by the user. It is the metric that will be adopted to compute the class means.</p><p>The field <code>means</code> is an <a href="https://marco-congedo.github.io/PosDefManifold.jl/dev/MainModule/#%E2%84%8DVector-type-1">ℍVector</a> holding the class means, i.e., one mean for each class. This field is not to be specified by the user, instead, the means are computed when the MDM model is fit using the <a href="../train_test/#PosDefManifoldML.fit!"><code>fit!</code></a> function and are accessible only thereafter.</p><p>(2)</p><p>Constructor creating and fitting an MDM model with training data <code>𝐏Tr</code>, an <a href="https://marco-congedo.github.io/PosDefManifold.jl/dev/MainModule/#%E2%84%8DVector-type-1">ℍVector</a> type, and labels <code>yTr</code>, an <a href="../MainModule/#IntVector-1">IntVector</a> type. The class means are computed according to the chosen <code>metric</code>, of type <a href="https://marco-congedo.github.io/PosDefManifold.jl/dev/MainModule/#Metric::Enumerated-type-1">Metric</a>. See <a href="https://marco-congedo.github.io/PosDefManifold.jl/dev/introToRiemannianGeometry/#metrics-1">here</a> for details on the metrics. Supported metrics are listed in the section about creating an <a href="../tutorial/#MDM-model-1">MDM model</a>.</p><p>Optional keyword arguments <code>w</code> and <code>✓w</code> are passed to the <a href="../train_test/#PosDefManifoldML.fit!"><code>fit!</code></a> function and have the same meaning therein.</p><p><strong>Examples</strong>:</p><pre><code class="language-none"># (1)
# generate some data
𝐏Tr, 𝐏Te, yTr, yTe = gen2ClassData(10, 30, 40, 60, 80)

# create a model
model = MDM(Fisher)

# fit the model with training data
fit!(model, 𝐏Tr, yTr)

# (2) equivalently and faster:
𝐏Tr, 𝐏Te, yTr, yTe=gen2ClassData(10, 30, 40, 60, 80)
model = MDM(Fisher, 𝐏Tr, yTr)</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/Marco-Congedo/PosDefManifoldML.jl/blob/75b24968ff284c3d856c8b1327e66f2cc723dc5a/src/mdm.jl#L15-L82">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="PosDefManifoldML.getMeans" href="#PosDefManifoldML.getMeans"><code>PosDefManifoldML.getMeans</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">function getMeans(metric :: Metric,
                  𝐏      :: ℍVector;
              tol :: Real = 0.,
              w   :: Vector = [],
              ✓w :: Bool   = true,
              ⏩ :: Bool   = true)</code></pre><p>Typically, you will not need this function as it is called by the <a href="../train_test/#PosDefManifoldML.fit!"><code>fit!</code></a> function.</p><p>Given a <code>metric</code> of type <a href="https://marco-congedo.github.io/PosDefManifold.jl/dev/MainModule/#Metric::Enumerated-type-1">Metric</a>, an <a href="https://marco-congedo.github.io/PosDefManifold.jl/dev/MainModule/#%E2%84%8DVector-type-1">ℍVector</a> of Hermitian matrices <code>𝐏</code> and an optional non-negative real weights vector <code>w</code>, return the (weighted) mean of the matrices in <code>𝐏</code>. This is used to fit MDM models.</p><p>This function calls the appropriate mean functions of package <a href="https://marco-congedo.github.io/PosDefManifold.jl/dev/">PostDefManifold</a>, depending on the chosen <code>metric</code>, and check that, if the mean is found by an iterative algorithm, then the iterative algorithm converges.</p><p>See method (3) of the <a href="https://marco-congedo.github.io/PosDefManifold.jl/dev/riemannianGeometry/#Statistics.mean">mean</a> function for the meaning of the optional keyword arguments <code>w</code>, <code>✓w</code> and <code>⏩</code>, to which they are passed.</p><p>The returned mean is flagged by Julia as an Hermitian matrix (see <a href="https://docs.julialang.org/en/v1/stdlib/LinearAlgebra/">LinearAlgebra</a>).</p></div></div><a class="source-link" target="_blank" href="https://github.com/Marco-Congedo/PosDefManifoldML.jl/blob/75b24968ff284c3d856c8b1327e66f2cc723dc5a/src/mdm.jl#L100-L134">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="PosDefManifoldML.getDistances" href="#PosDefManifoldML.getDistances"><code>PosDefManifoldML.getDistances</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">function getDistances(metric :: Metric,
                      means  :: ℍVector,
                      𝐏      :: ℍVector)</code></pre><p>Typically, you will not need this function as it is called by the <a href="../train_test/#PosDefManifoldML.predict"><code>predict</code></a> function.</p><p>Given an <a href="https://marco-congedo.github.io/PosDefManifold.jl/dev/MainModule/#%E2%84%8DVector-type-1">ℍVector</a> <code>𝐏</code> holding <span>$k$</span> Hermitian matrices and an ℍVector <code>means</code> holding <span>$z$</span> matrix means, return the distance of each matrix in <code>𝐏</code> to the means in <code>means</code>.</p><p>The distance is computed according to the chosen <code>metric</code>, of type <a href="https://marco-congedo.github.io/PosDefManifold.jl/dev/MainModule/#Metric::Enumerated-type-1">Metric</a>. See <a href="https://marco-congedo.github.io/PosDefManifold.jl/dev/introToRiemannianGeometry/#metrics-1">metrics</a> for details on the supported distance functions.</p><p>The result is a <span>$z$</span>x<span>$k$</span> matrix of distances.</p></div></div><a class="source-link" target="_blank" href="https://github.com/Marco-Congedo/PosDefManifoldML.jl/blob/75b24968ff284c3d856c8b1327e66f2cc723dc5a/src/mdm.jl#L165-L186">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="PosDefManifoldML.CV_mdm" href="#PosDefManifoldML.CV_mdm"><code>PosDefManifoldML.CV_mdm</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">function CV_mdm(metric :: Metric,
                𝐏Tr    :: ℍVector,
                yTr    :: IntVector,
                nCV    :: Int;
            scoring   :: Symbol = :b,
            confusion :: Bool   = false,
            shuffle   :: Bool   = false)</code></pre><p>Typically, you will not need this function as it is called by the <a href="../train_test/#PosDefManifoldML.CVscore"><code>CVscore</code></a> function.</p><p>This function return the same thing and has the same arguments as the <a href="../train_test/#PosDefManifoldML.CVscore"><code>CVscore</code></a> function, with the exception of the first argument, that here is a <code>metric</code> of type <a href="https://marco-congedo.github.io/PosDefManifold.jl/dev/MainModule/#Metric::Enumerated-type-1">Metric</a>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/Marco-Congedo/PosDefManifoldML.jl/blob/75b24968ff284c3d856c8b1327e66f2cc723dc5a/src/mdm.jl#L195-L214">source</a></section><footer><hr/><a class="previous" href="../tools/"><span class="direction">Previous</span><span class="title">Tools</span></a></footer></article></body></html>
