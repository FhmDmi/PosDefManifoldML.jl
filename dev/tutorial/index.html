<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Tutorials · PosDefManifoldML</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link href="../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><a href="../"><img class="logo" src="../assets/logo.png" alt="PosDefManifoldML logo"/></a><h1>PosDefManifoldML</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../">PosDefManifoldML Documentation</a></li><li class="current"><a class="toctext" href>Tutorials</a><ul class="internal"><li><a class="toctext" href="#ML-models-1">ML models</a></li><li><a class="toctext" href="#load-data-1">load data</a></li><li><a class="toctext" href="#train-a-model-(fit)-1">train a model (fit)</a></li><li><a class="toctext" href="#classify-data-(predict)-1">classify data (predict)</a></li></ul></li><li><a class="toctext" href="../MainModule/">Main Module</a></li><li><a class="toctext" href="../train_test/">Training-Testing</a></li><li><a class="toctext" href="../tools/">Tools</a></li><li><span class="toctext">Machine Learning Models</span><ul><li><a class="toctext" href="../mdm/">Minimum Distance to Mean</a></li></ul></li></ul></nav><article id="docs"><header><nav><ul><li><a href>Tutorials</a></li></ul><a class="edit-page" href="https://github.com/Marco-Congedo/PosDefManifoldML.jl/blob/master/docs/src/tutorial.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Tutorials</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="Tutorial-1" href="#Tutorial-1">Tutorial</a></h1><p><em>PosDefManifoldML</em> mimicks the functioning of <a href="https://scikit-learn.org/stable/">ScikitLearn</a> (good to know if you are familir with it): first a <strong>machine learning (ML) model</strong> is created, then data is used to <strong>fit</strong> (train) the model. Once this is done the model allows to <strong>predict</strong> the labels of test data or the probability of the data to belong to each class.</p><p>In order to compare ML models, a <strong>cross-validation</strong> procedure is implemented.</p><h2><a class="nav-anchor" id="ML-models-1" href="#ML-models-1">ML models</a></h2><p>For the moment being, only the <strong>Riemannian minimum distance to mean</strong> (MDM) ML model is implemented. The creation of other models will follow the same rationale and syntax, along the lines of <em>ScikitLearn</em>.</p><h3><a class="nav-anchor" id="MDM-model-1" href="#MDM-model-1">MDM model</a></h3><p>An MDM model is created as</p><pre><code class="language-none">model = MDM(metric)</code></pre><p>where <code>metric</code> must be a metric in the manifold of positive definite matrices allowing the definition of both a distance function and of a mean (center of mass).</p><p>Currently supported metrics are:</p><table><tr><th style="text-align: left">Metric (distance)</th><th style="text-align: left">Resulting mean estimation</th></tr><tr><td style="text-align: left">Euclidean</td><td style="text-align: left">Arithmetic</td></tr><tr><td style="text-align: left">invEuclidean</td><td style="text-align: left">Harmonic</td></tr><tr><td style="text-align: left">ChoEuclidean</td><td style="text-align: left">Cholesky Euclidean</td></tr><tr><td style="text-align: left">logEuclidean</td><td style="text-align: left">Log-Euclidean</td></tr><tr><td style="text-align: left">logCholesky</td><td style="text-align: left">Log-Cholesky</td></tr><tr><td style="text-align: left">Fisher</td><td style="text-align: left">Fisher (Cartan, Karcher, Pusz-Woronowicz,...)</td></tr><tr><td style="text-align: left">logdet0</td><td style="text-align: left">LogDet (S, α, Bhattacharyya, Jensen,...)</td></tr><tr><td style="text-align: left">Jeffrey</td><td style="text-align: left">Jeffrey (symmetrized Kullback-Leibler)</td></tr><tr><td style="text-align: left">Wasserstein</td><td style="text-align: left">Wasserstein (Bures, Hellinger, ...)</td></tr></table><p>Do not use the Von Neumann metric, which is also supported in <em>PosDefManifold</em>, since it does not allow a definition of mean.</p><p>You can also create and fit an MDM model in one pass. See <a href="../mdm/#PosDefManifoldML.MDM"><code>MDM</code></a>.</p><h2><a class="nav-anchor" id="load-data-1" href="#load-data-1">load data</a></h2><p>After a classifier instance is created we need to fit the classifier model with  data. For convenience, let us use the <strong>npz</strong> format(.npz), which allows sharing data between <em>Python</em> and <em>Julia</em>. For example:</p><pre><code class="language-none">	using NPZ

	path = &quot;/home/saloni/PosDefManifoldML/src/&quot; # where files are stored
	filename = &quot;subject_1.npz&quot; # for subject number i
	data = npzread(path*filename)
	X = data[&quot;data&quot;] # retrive the epochs
	y = data[&quot;labels&quot;] # retrive the corresponding labels</code></pre><p>This corresponds to the training part. The training data should be in the form of :</p><ul><li><code>𝐗</code> :-  Vector of Hermitian Matrices. These Hermitian Matrices are the covariance matrices formed   		    out of the raw data. The raw data of signals first need to be converted into their 		   corresponding covariance matrices. This can be very easily done using the <a href="https://marco-congedo.github.io/PosDefManifold.jl/latest/signalProcessing/#PosDefManifold.gram">gram</a> function of 		    <strong>PosDefManifold</strong>. This is what is done in the below code.</li><li><code>y</code> :-  Labels corresponding to each training sample. Labels should be integers from 1 to n, where  		   n is the number of classes.</li></ul><pre><code class="language-none">train_size = size(X,1)
𝐗 = ℍVector(undef, sam_size)
@threads for i = 1:train_size
	 	𝐗[i] = gram(X[i,:,:])
end</code></pre><h2><a class="nav-anchor" id="train-a-model-(fit)-1" href="#train-a-model-(fit)-1">train a model (fit)</a></h2><p>Once you are ready with your data, you can fit your model calling the <code>fit!</code> function.</p><pre><code class="language-none">fit!(model, 𝐗 ,y)</code></pre><p>Note that you can also use the construtor</p><p><code>model=MDM(Fisher, 𝐗, y)</code>,</p><p>which creates and fits the model at once.</p><h2><a class="nav-anchor" id="classify-data-(predict)-1" href="#classify-data-(predict)-1">classify data (predict)</a></h2><p>Let 𝐓 be a vector of Hermitian matrices forming the <strong>testing set</strong>. In order to classify them, i.e., to associate a class label to them, we invoke</p><p><code>predict(model, 𝐓, :l)</code>.</p><p>If instead we wish to estimate the probabilities for the matrices in 𝐓 of belonging to each class, we invoke</p><p><code>predict(model, 𝐓, :p)</code>.</p><h3><a class="nav-anchor" id="cross-validation-1" href="#cross-validation-1">cross-validation</a></h3><p>In order to assess the performance of a model usually a <strong>cross-validation (CV)</strong> procedure is adopted. In <em>PosDefManifoldML</em> a random CV procedure is implemented. We invoke it by</p><p><code>CVscore(model, 𝐓, y, 5)</code>,</p><p>where <code>5</code> is the number of CVs. This implies that at each CV, 1/5th of the matrices is used for training and the remaining for testing.</p><footer><hr/><a class="previous" href="../"><span class="direction">Previous</span><span class="title">PosDefManifoldML Documentation</span></a><a class="next" href="../MainModule/"><span class="direction">Next</span><span class="title">Main Module</span></a></footer></article></body></html>
